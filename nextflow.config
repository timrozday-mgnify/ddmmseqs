/*
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    nf-core/genomeannotation Nextflow config file
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Default config options for all compute environments
----------------------------------------------------------------------------------------
*/

manifest {
    mainScript = "main.nf"
    name = 'ddmmseqs'
    description = 'DIAMOND-divide followed by mmseqs-linclust to cluster very large (>1B) protein sequence collections.'
    version = '0.1'
}

plugins {
    id 'nf-amazon'
    id 'nf-schema@2.2.0'
}

nextflow.enable.strict = true

params {
    samplesheet = ''
    outdir = "results"
    publish_dir_mode = 'copy'
    singularity_cachedir = "singularity_cache"
    conda_cachedir = "conda_cache"
    trace_report_suffix = ""

    target_cluster_size = 10000000
    diamond_min_seq_identity = 0.8
    diamond_min_cov = 0.8
    mmseqs_min_seq_identity = 0.9
    mmseqs_min_cov = 0.9
}

singularity {
    enabled = true
    autoMounts = true
    cacheDir = params.singularity_cachedir
}

conda {
    enabled = true
    cacheDir = params.conda_cachedir
}

apptainer.registry = 'quay.io'
docker.registry = 'quay.io'
podman.registry = 'quay.io'
singularity.registry = 'quay.io'
charliecloud.registry = 'quay.io'

// Disable process selector warnings by default.
nextflow.enable.configProcessNamesValidation = false

timeline {
    enabled = true
    file = "${params.outdir}/pipeline_info/execution_timeline${params.trace_report_suffix}.html"
    overwrite = true
}
report {
    enabled = true
    file = "${params.outdir}/pipeline_info/execution_report${params.trace_report_suffix}.html"
    overwrite = true
}
trace {
    enabled = true
    file = "${params.outdir}/pipeline_info/execution_trace${params.trace_report_suffix}.txt"
    overwrite = true
}
dag {
    enabled = true
    file = "${params.outdir}/pipeline_info/pipeline_dag${params.trace_report_suffix}.html"
    overwrite = true
}

includeConfig 'conf/modules.config'

profiles {
    local {
        includeConfig 'conf/local.config'
    }
}